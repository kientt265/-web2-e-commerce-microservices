generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("MAIL_DATABASE_URL")
}

model email_retry_log {
  id            BigInt    @id @default(autoincrement())
  email_id      BigInt
  retry_count   Int?      @default(0)
  error_message String?
  retried_at    DateTime? @default(now()) @db.Timestamp(6)
  emails        emails    @relation(fields: [email_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model email_templates {
  id         BigInt    @id @default(autoincrement())
  name       String    @db.VarChar(100)
  subject    String    @db.VarChar(255)
  body       String
  created_at DateTime? @default(now()) @db.Timestamp(6)
  updated_at DateTime? @default(now()) @db.Timestamp(6)
  emails     emails[]
}

model emails {
  id              BigInt            @id @default(autoincrement())
  recipient       String            @db.VarChar(255)
  subject         String            @db.VarChar(255)
  body            String
  status          email_status?     @default(PENDING)
  template_id     BigInt?
  sent_at         DateTime?         @db.Timestamp(6)
  created_at      DateTime?         @default(now()) @db.Timestamp(6)
  updated_at      DateTime?         @default(now()) @db.Timestamp(6)
  email_retry_log email_retry_log[]
  email_templates email_templates?  @relation(fields: [template_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

enum email_status {
  PENDING
  SENT
  FAILED
}
